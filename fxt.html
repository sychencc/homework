<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>科赫三角形</title>
    <style>
        canvas {
            background-color: #ffffff;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        canvas.width = 800;
        canvas.height = 800;

        const depth = 4;
        const color = '#00008B';

        function drawKochSnowflake(x1, y1, x2, y2, x3, y3, depth) {
            if (depth === 0) {
                ctx.beginPath();
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.lineTo(x3, y3);
                ctx.lineTo(x1, y1);
                ctx.strokeStyle = color;
                ctx.stroke();
                return;
            }

            const x12 = (x1 + x2) / 2;
            const y12 = (y1 + y2) / 2;
            const x23 = (x2 + x3) / 2;
            const y23 = (y2 + y3) / 2;
            const x31 = (x3 + x1) / 2;
            const y31 = (y3 + y1) / 2;

            const dx = x2 - x1;
            const dy = y2 - y1;
            const len = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx);

            const xA = x1 + dx / 3;
            const yA = y1 + dy / 3;
            const xB = xA + Math.cos(angle - Math.PI / 3) * len / 3;
            const yB = yA + Math.sin(angle - Math.PI / 3) * len / 3;
            const xC = x1 + 2 * dx / 3;
            const yC = y1 + 2 * dy / 3;

            drawKochSnowflake(x1, y1, xA, yA, xB, yB, depth - 1);
            drawKochSnowflake(xA, yA, xB, yB, xC, yC, depth - 1);
            drawKochSnowflake(xB, yB, xC, yC, x2, y2, depth - 1);
            drawKochSnowflake(xA, yA, xC, yC, x23, y23, depth - 1);
        }

        const size = 600;
        const x1 = canvas.width / 2 - size / 2;
        const y1 = canvas.height / 2 + size / (2 * Math.sqrt(3));
        const x2 = canvas.width / 2 + size / 2;
        const y2 = canvas.height / 2 + size / (2 * Math.sqrt(3));
        const x3 = canvas.width / 2;
        const y3 = canvas.height / 2 - size / Math.sqrt(3);

        drawKochSnowflake(x1, y1, x2, y2, x3, y3, depth);

        ctx.fillStyle = '#333';
        ctx.font = '30px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('科赫三角形', canvas.width / 2, 40);
    </script>
</body>
</html>